<script>
  var map;
  var marker;
  function initialize() {
    var myLatlng = new google.maps.LatLng(42.861118,74.607811);
    var myOptions = {
        zoom: 12,
        center: myLatlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    google.maps.event.addListener(map, 'click', function(event) {
      placeMarker(event.latLng);
    });
    marker = new google.maps.Marker({
        position: myLatlng,
        map: map
    });
    $("#report_latitude").val(myLatlng.lat());
    $("#report_longtitude").val(myLatlng.lng());
  }

  function loadScript() {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "http://maps.google.com/maps/api/js?sensor=false&callback=initialize";
    document.body.appendChild(script);
  }

  function placeMarker(location) {
    marker.setPosition(location);
    $("#report_latitude").val(location.lat());
    $("#report_longtitude").val(location.lng());
  }
  window.onload = loadScript;
</script>
<div class="grid_8">
  <div id="map_canvas"></div>
</div>
<div class="grid_4">
  <%= form_for @report, :html => {:multipart => true} do |r| %>
    <%= r.label :title %>
    <%= r.text_field :title %>
    <div style="display:none">
      <%= r.text_field  :latitude %>
      <%= r.text_field  :longtitude %>
    </div>
    <%= r.label :description %>
    <%= r.text_area :description %>

    <%= r.file_field :photo1 %>
    <%= r.file_field :photo2 %>
    <%= r.file_field :photo3 %>
    <%= r.file_field :photo4 %>
    <%= r.file_field :photo5 %>
    <%= r.submit "Save" %>
<% end %>
</div>
<div class="clear"></div>
